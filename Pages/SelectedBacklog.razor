@page "/selectedBacklog/{id}"
@using Microsoft.Graph

@inject BacklogsWeb.Graph.GraphClientFactory clientFactory

<AuthorizeView>
	<div class="row">
		<div class="col">
			<table>
				<tr>
					<img src=@selectedBacklog?.ImageURL height=200 width=200 />
				</tr>
				<tr>
					<div>
						<h5>@selectedBacklog?.Name</h5>
						<h6>@selectedBacklog?.Director</h6>
						<p>@selectedBacklog?.Description</p>
					</div>
				</tr>
			</table>
		</div>
	</div>
</AuthorizeView>

@code {
	[CascadingParameter]
	private Task<AuthenticationState>? authenticationState { get; set; }
	[Parameter]
	public string id { get; set; }
	private GraphServiceClient? graphClient;
	private List<Backlog>? allBacklogs;
	private Backlog? selectedBacklog;

	protected override async Task OnInitializedAsync()
	{
		graphClient = clientFactory.GetAuthenticatedClient();
		var user = (await authenticationState).User;

		//await BacklogsSingleton.GetInstance().ReadDataAsync(graphClient);
		allBacklogs = BacklogsSingleton.GetInstance().GetIncompleteBacklogs();
	}

	protected override void OnParametersSet()
	{
		selectedBacklog = allBacklogs?.First(b => b.Id.ToString() == id);
	}
}
